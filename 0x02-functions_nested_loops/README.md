this are c functions and nested loops